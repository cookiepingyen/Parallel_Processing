# 平行處理

## 平行處理資料載入/寫入速度

## 硬體規格
### CPU AMD 3750H  |  P-Core:4 E-Core:0 Threads:8
### RAM 16GB


### 實驗0
#### 實驗0-1 初始時間(讀取+寫入)：

| 筆數 | 讀取秒數(s) | 寫入秒數(s) | 總共耗時(s) | 記憶體用量(mb) |
|------|------|------|------|------------|
| 1,000 | 0.023 | | 1.332 | 13 |
| 5,000 | 0.051 | | 3.738 |
| 10,000 | 0.088 | | 6.141 |
| 50,000 | 0.287 | | 25.998 |
| 100,000 | 0.703 | | 51.254 |
| 200,000 | 1.644 | | 99.917 |
| 500,000 | 3.104 | | 240.763 |
| 1,000,000 | 5.85 | | 550.215 |
| 2,000,000 | 10.04 | | |
| 3,000,000 | 14.421 | | |
| 5,000,000 | 23.784 | | |
| 10,000,000 | 57.193 | | |

#### 實驗0-2 優化寫入後(讀取+寫入)：

| 筆數 | 讀取秒數(s) | 寫入秒數(s) | 總共耗時(s) | 記憶體用量(mb) |
|------|------|------|------|------------|
| 1,000 | 0.046 | 0.009 | 0.055 | 11 |
| 5,000 | 0.066 | 0.022 | 0.088 | 14 |
| 10,000 | 0.088 | 0.05 | 0.139 | 17 |
| 50,000 | 0.653 | 0.286 | 0.939 | 26 |
| 100,000 | 0.999 | 0.566 | 1.565 | 40 |
| 200,000 | 1.877 | 0.459 | 2.336 | 64 |
| 500,000 | 3.904 | 1.19 | 5.094 | 133 |
| 1,000,000 | 6.32 | 2.111 | 8.431 | 253 |
| 2,000,000 | 13.514 | 4.724 | 18.238 | 488 |
| 3,000,000 | 16.612 | 7.62 | 24.232 | 725 |
| 5,000,000 | 27.722 | 13.137 | 40.859 | 1.2G |
| 10,000,000 | 67.777 | 62.346 | 130.123 | 2.3G |
| 12,000,000 | 79.637 | 57.855 | 137.492 | 2.8G |
| 24,000,000 | out_of_memory |  |  |  |
| 30,000,000 |  |  |  |  |
| 40,000,000 |  |  |  |  |


### 實驗1 分批讀取
* 每次批次都要清除記憶體
#### 1-1 每100萬為一批次
| 筆數 | 讀取秒數(s) | 記憶體用量(mb) |
|------|-----|------------|
| 5,000,000 | 19.64 |  |
| 10,000,000 | 39.37 | - |

#### 1-2 每150萬為一批次
| 筆數 | 讀取秒數(s) | 記憶體用量(mb) |
|------|-----|------------|
| 5,000,000 | 19.71 |  |
| 10,000,000 | 41.24 | - |

#### 1-3 每200萬為一批次
| 筆數 | 讀取秒數(s) | 記憶體用量(mb) |
|------|-----|------------|
| 5,000,000 | 21.62 |  |
| 10,000,000 | 37.47 | - |

#### 1-4 每250萬為一批次
| 筆數 | 讀取秒數(s) | 記憶體用量(mb) |
|------|-----|------------|
| 5,000,000 | 21.48 |  |
| 10,000,000 | 37.6 | - |

#### 1-5 每300萬為一批次
| 筆數 | 讀取秒數(s) | 記憶體用量(mb) |
|------|-----|------------|
| 5,000,000 | 23.45 |  |
| 10,000,000 | 39.08 | - |

#### 1-6 每350萬為一批次
| 筆數 | 讀取秒數(s) | 記憶體用量(mb) |
|------|-----|------------|
| 5,000,000 | 24.35 |  |
| 10,000,000 | 43.12 | - |

#### 1-7 每400萬為一批次
| 筆數 | 讀取秒數(s) | 記憶體用量(mb) |
|------|-----|------------|
| 5,000,000 | 27.04 |  |
| 10,000,000 | 50.03 | - |

### 實驗2 分批讀取 + 批次寫入
#### 2-1 每100萬筆一次
| 筆數 | 平均讀取秒數(s) | 平均寫入秒數(s) | 總執行時間(s) |  記憶體用量(mb) |
|------|-----|----|-----|------|
| 5,000,000 | 14.95 | 4.23 | 19.62 | 1200 |
| 10,000,000 | 26.92 | 8.09 | 45.48 | 1700 |

#### 2-2 每150萬筆一次
| 筆數 | 平均讀取秒數(s) | 平均寫入秒數(s) | 總執行時間(s) |  記憶體用量(mb) |
|------|-----|----|-----|------|
| 5,000,000 | 16.375 | 6.685 | 25.66 | 1100 |
| 10,000,000 | 34.02 | 12.7 | 48.13 | 2200 |

#### 2-3 每200萬筆一次
| 筆數 | 平均讀取秒數(s) | 平均寫入秒數(s) | 總執行時間(s) |  記憶體用量(mb) |
|------|-----|----|-----|------|
| 5,000,000 | 16.68 | 7.33 | 24.9 | 1100 |
| 10,000,000 | 31.63 | 14.75 | 49.42 | 2300 |

#### 2-4 每250萬筆一次
| 筆數 | 平均讀取秒數(s) | 平均寫入秒數(s) | 總執行時間(s) |  記憶體用量(mb) |
|------|-----|----|-----|------|
| 5,000,000 | 18.595 | 6.695 | 25.51 | 1200 |
| 10,000,000 | 35.43 | 17.13 | 53.79 | 2200 |

#### 2-5 每300萬筆一次
| 筆數 | 平均讀取秒數(s) | 平均寫入秒數(s) | 總執行時間(s) |  記憶體用量(mb) |
|------|-----|----|-----|------|
| 5,000,000 | 17.725 | 6.575 | 26.4 | 1100 |
| 10,000,000 | 39.325 | 10.515 | 52.66 | 2200 |

#### 2-6 每350萬筆一次
| 筆數 | 平均讀取秒數(s) | 平均寫入秒數(s) | 總執行時間(s) |  記憶體用量(mb) |
|------|-----|----|-----|------|
| 5,000,000 | 16.76 | 6.665 | 28.49 | 1100 |
| 10,000,000 | 36.35 | 19.13 | 59.15 | 2300 |

#### 2-7 每400萬筆一次
| 筆數 | 平均讀取秒數(s) | 平均寫入秒數(s) | 總執行時間(s) |  記憶體用量(mb) |
|------|-----|----|-----|------|
| 5,000,000 | 16.955 | 6.705 | 32.92 | 1007 |
| 10,000,000 | 35.27 | 13.3 | 54.09 | 2300 |

#### 每50000筆一次
| 筆數 | 秒數(s) | 記憶體用量(mb) |
|------|-----|------------|
| 10,000 |- | - |
| 50,000 | 0.918 | 21 |
| 100,000 | 2.428 | 20 |
| 150,000 | 3.887 | 21 |
| 200,000 | 4.099 | 21 |
| 500,000 | 9.954 | 21 |
| 1,000,000 | 38.197 | 21 |
| 5,000,000 | 520.18 | 21 |
| 10,000,000 | - | - |
#### 每50000筆一次 (GC)
| 筆數 | 秒數(s) | 記憶體用量(mb) |
|------|-----|------------|
| 10,000 |- | - |
| 50,000 | 1.142 | 30 |
| 100,000 | 1.497 | 41 |
| 150,000 | 2.992 | 46 |
| 200,000 | 4.686 | 51 |
| 500,000 | 7.435 | 63 |
| 1,000,000 | 12.957 | 66 |
| 5,000,000 | 158.046 | 65 |
| 10,000,000 | - | - |

#### 每50000筆一次 (固態硬碟＋GC)
| 筆數 | 秒數(s) | 記憶體用量(mb) |
|------|-----|------------|
| 10,000 |- | - |
| 50,000 | 1.235 | 30 |
| 100,000 | 2.294 | 41 |
| 150,000 | 2.968 | 47 |
| 200,000 | 3.632 | 65 |
| 500,000 | 6.999 | 65 |
| 1,000,000 | 12.79 | 65 |
| 5,000,000 | 158.046 | 65 |
| 10,000,000 | - | - |

#### 讀取 + 寫入 五條執行緒
| 筆數 | 秒數(s) | 記憶體用量(mb) |
|------|-----|------------|
| 10,000 | 0.099 | 15 |
| 50,000 | 0.248 | 22 |
| 100,000 | 0.389 | 15 |
| 150,000 | 0.49 | 15 |
| 200,000 | 0.506| 15 |
| 500,000 | 1.309 | 15 |
| 1,000,000 | 2.695 | 15 |
| 5,000,000 | 55 | 15 |
| 10,000,000 | 115.948 | 164 |